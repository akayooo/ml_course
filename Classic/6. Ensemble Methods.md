# –ê–Ω—Å–∞–º–±–ª–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã: Random Forest, Boosting –∏ Gradient Boosting

–î–æ —Å–∏—Ö –ø–æ—Ä –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ –æ–± –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö: –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π, SVM, k-NN. –ö–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö –∏–º–µ–µ—Ç —Å–≤–æ–∏ —Å–ª–∞–±–æ—Å—Ç–∏. –î–µ—Ä–µ–≤—å—è –ø–µ—Ä–µ–æ–±—É—á–∞—é—Ç—Å—è, SVM –º–µ–¥–ª–µ–Ω–µ–Ω –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, k-NN –Ω–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è.

–ê–Ω—Å–∞–º–±–ª–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã —Ä–µ—à–∞—é—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É. –ò–¥–µ—è –ø—Ä–æ—Å—Ç–∞—è: –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ —Å–∏–ª—å–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–Ω–æ–≥–æ —Å–ª–∞–±—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∏ –∫–∞–∂–¥—ã–π –≥–æ–ª–æ—Å—É–µ—Ç. –ö–∞–∫ –≤ –∂–∏–∑–Ω–∏: –µ—Å–ª–∏ 100 —á–µ–ª–æ–≤–µ–∫ –≥–æ–≤–æ—Ä—è—Ç, —á—Ç–æ —ç—Ç–æ —Å–ø–∞–º, –≤–µ—Ä–æ—è—Ç–Ω–µ–µ –≤—Å–µ–≥–æ, —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–ø–∞–º, —á–µ–º –µ—Å–ª–∏ –æ–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫ —Å–∫–∞–∂–µ—Ç.

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é –∞–Ω—Å–∞–º–±–ª–µ–π:
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ: –∫–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ (Random Forest, Bagging)
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ: –∫–∞–∂–¥–∞—è –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π (AdaBoost, Boosting)
- –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –∫–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Å—Ç–∞—Ç–∫–∏ (Gradient Boosting)

–í–º–µ—Å—Ç–µ —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –æ–±—Ä–∞–∑—É—é—Ç –æ—Å–Ω–æ–≤—É —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≤—ã–∏–≥—Ä—ã–≤–∞—é—â–∏—Ö —Ä–µ—à–µ–Ω–∏–π –Ω–∞ Kaggle –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–º–µ–Ω–Ω–æ –∞–Ω—Å–∞–º–±–ª–∏.

---

## –ß–∞—Å—Ç—å 1: –°–ª—É—á–∞–π–Ω—ã–µ –ª–µ—Å–∞ (Random Forest)

### –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∫—É–ø–∏—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—É –∏ –ø–æ–ø—Ä–æ—Å–∏–ª–∏ —Å–æ–≤–µ—Ç–∞ —É 100 —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ –ø–æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏. –ï—Å–ª–∏ –≤—Å–µ –æ–Ω–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ (–Ω–µ —Å–æ–≤–µ—Ç—É—è—Å—å –º–µ–∂–¥—É —Å–æ–±–æ–π) –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç –∏ 70 –∏–∑ –Ω–∏—Ö —Å–∫–∞–∑–∞–ª–∏ "—ç—Ç–æ —Ö–æ—Ä–æ—à–∞—è –ø–æ–∫—É–ø–∫–∞", —Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —ç—Ç–æ –ø—Ä–∞–≤–¥–∞.

Random Forest —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–æ–≤–Ω–æ —Ç–∞–∫ –∂–µ. –í–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ —Ä–µ—à–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å—Å—è, –≤—ã—Ä–∞—Å—Ç–∏–º 100 –¥–µ—Ä–µ–≤—å–µ–≤ –Ω–∞ —Å–ª–µ–≥–∫–∞ —Ä–∞–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ö–∞–∂–¥–æ–µ –¥–µ—Ä–µ–≤–æ —Å–¥–µ–ª–∞–µ—Ç —Å–≤–æ—ë –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ, –∞ –∑–∞—Ç–µ–º –º—ã –≤–æ–∑—å–º—ë–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤.

–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è: —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ. –ï—Å–ª–∏ –≤—Å–µ 100 —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ –≥–æ–≤–æ—Ä—è—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –ø–æ—Ç–æ–º—É, —á—Ç–æ –æ–Ω–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, —ç—Ç–æ –º–µ–Ω–µ–µ —Ü–µ–Ω–Ω–æ, —á–µ–º –µ—Å–ª–∏ 100 —Ä–∞–∑–Ω—ã—Ö –ª—é–¥–µ–π –ø—Ä–∏—à–ª–∏ –∫ –æ–¥–Ω–æ–º—É –≤—ã–≤–æ–¥—É –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.

### –ö–∞–∫ —Å—Ç—Ä–æ–∏—Ç—Å—è Random Forest

–ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π: Bagging –∏ —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

**Bagging (Bootstrap Aggregating):**

1. –ò–∑ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–æ–º $N$ –¥–µ–ª–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –≤—ã–±–æ—Ä–∫—É —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º —Ä–∞–∑–º–µ—Ä–æ–º $N$
2. –û–±—É—á–∞–µ–º –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π –Ω–∞ —ç—Ç–æ–π –≤—ã–±–æ—Ä–∫–µ
3. –ü–æ–≤—Ç–æ—Ä—è–µ–º $B$ —Ä–∞–∑ (–æ–±—ã—á–Ω–æ 100-1000 —Ä–∞–∑)

–ß—Ç–æ –∑–Ω–∞—á–∏—Ç "—Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º"? –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ø—Ä–∏–º–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–±—Ä–∞–Ω –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º–µ—Ä—ã –Ω–µ –±—É–¥—É—Ç –≤—ã–±—Ä–∞–Ω—ã –≤–æ–æ–±—â–µ. –≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è bootstrap sample.

**–°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:**

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ –∫–∞–∂–¥–æ–º —Ä–∞–∑–±–∏–µ–Ω–∏–∏ –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –≤—ã–±–∏—Ä–∞–µ–º –Ω–µ –≤—Å–µ $p$ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∞ —Ç–æ–ª—å–∫–æ —Å–ª—É—á–∞–π–Ω–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑ –Ω–∏—Ö. –û–±—ã—á–Ω–æ:
- –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: $\sqrt{p}$ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –î–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏: $p/3$ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–≠—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ—â—ë –±–æ–ª—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –º–µ–∂–¥—É –¥–µ—Ä–µ–≤—å—è–º–∏.

**–§–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:**

–î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: –±–µ—Ä—ë–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤ (mode)
–î–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏: –±–µ—Ä—ë–º —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã Random Forest

**n_estimators (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤):**

–û–±—ã—á–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: 64-1000. –ë–æ–ª—å—à–µ –¥–µ—Ä–µ–≤—å–µ–≤ = —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è.

–ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ –æ–±—ã—á–Ω–æ –≤–∏–¥–Ω–æ: —Å–Ω–∞—á–∞–ª–∞ —Ç–æ—á–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ —Ä–∞—Å—Ç—ë—Ç, –ø–æ—Ç–æ–º –≤—ã—Ö–æ–¥–∏—Ç –Ω–∞ –ø–ª–∞—Ç–æ. –ù–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 10000 –¥–µ—Ä–µ–≤—å–µ–≤, –µ—Å–ª–∏ 200 —É–∂–µ –¥–∞—é—Ç —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

> [!TIP]
> –ù–∞—á–Ω–∏—Ç–µ —Å 100 –¥–µ—Ä–µ–≤—å–µ–≤. –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ—Å—Ç–∞–±–∏–ª–µ–Ω, –¥–æ–±–∞–≤—å—Ç–µ –¥–æ 500. –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–∞—è, —Å–Ω–∞—á–∞–ª–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ max_depth –∏–ª–∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∞ –Ω–µ —É–º–µ–Ω—å—à–∞–π—Ç–µ n_estimators.

**max_depth (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞):**

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (None). –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞, –¥–µ—Ä–µ–≤—å—è –≤ –ª–µ—Å—É –æ–±—ã—á–Ω–æ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–ª—è—Ç—å –≥–ª—É–±–æ–∫–∏–º–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –∞–Ω—Å–∞–º–±–ª—å –≤ —Ü–µ–ª–æ–º –Ω–µ –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—Å—è –∏–∑-–∑–∞ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è.

–ù–æ –∏–Ω–æ–≥–¥–∞ –ø–æ–ª–µ–∑–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:
- –ï—Å–ª–∏ —É –≤–∞—Å –º–Ω–æ–≥–æ —à—É–º–∞ –≤ –¥–∞–Ω–Ω—ã—Ö
- –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É—Å–∫–æ—Ä–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ

**max_features (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ —Ä–∞–∑–±–∏–µ–Ω–∏–µ):**

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: $\sqrt{p}$ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, $p$ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

–£–º–µ–Ω—å—à–µ–Ω–∏–µ max_features –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –º–µ–∂–¥—É –¥–µ—Ä–µ–≤—å—è–º–∏, –Ω–æ –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞.

**min_samples_split –∏ min_samples_leaf:**

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è —É–∑–ª–∞ –∏ –º–∏–Ω–∏–º—É–º –≤ –ª–∏—Å—Ç–æ–≤–æ–º —É–∑–ª–µ. –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–º–æ–≥–∞—é—Ç –±–æ—Ä–æ—Ç—å—Å—è —Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º –Ω–∞ —à—É–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**bootstrap:**

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ bootstrap sampling. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é True. –ï—Å–ª–∏ False, –∫–∞–∂–¥–æ–µ –¥–µ—Ä–µ–≤–æ –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –≤—Å–µ–π –≤—ã–±–æ—Ä–∫–µ, —á—Ç–æ –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –¥–µ—Ä–µ–≤—å—è –±—É–¥—É—Ç –±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–∏ –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞.

**n_jobs:**

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ -1, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã.

### Out-of-Bag (OOB) –æ—à–∏–±–∫–∞

–í–æ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ Bagging: –≤ —Å—Ä–µ–¥–Ω–µ–º –æ–∫–æ–ª–æ 37% –ø—Ä–∏–º–µ—Ä–æ–≤ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞ (—Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ out-of-bag –ø—Ä–∏–º–µ—Ä—ã).

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –æ—à–∏–±–∫–∏, –Ω–µ —Å—Ç—Ä–æ—è –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É!

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `oob_score=True`, –∏ –º–æ–¥–µ–ª—å –≤—ã—á–∏—Å–ª–∏—Ç OOB –æ—à–∏–±–∫—É. –û–Ω–∞ —á–∞—Å—Ç–æ —Ö–æ—Ä–æ—à–∏–π –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏.

> [!IMPORTANT]
> OOB –æ—à–∏–±–∫–∞ ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏. –≠—Ç–æ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è Random Forest, –Ω–æ –ø–æ–º–Ω–∏—Ç–µ: —ç—Ç–æ –≤—Å—ë –µ—â—ë –æ—Ü–µ–Ω–∫–∞ –Ω–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –Ω–∞ —á–µ—Å—Ç–Ω–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ.

**–§–æ—Ä–º–∞–ª—å–Ω–æ:**

–ï—Å–ª–∏ –ø—Ä–∏–º–µ—Ä–Ω—ã–π $i$ –Ω–µ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ $t$, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –¥–µ—Ä–µ–≤–æ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ $i$. –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤—Å–µ—Ö —Ç–∞–∫–∏—Ö –¥–µ—Ä–µ–≤—å–µ–≤ –∏ —É—Å—Ä–µ–¥–Ω—è–µ–º.

### –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Feature Importance)

Random Forest –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å `.feature_importances_`.

–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç? –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ —Å–º–æ—Ç—Ä–∏–º: –Ω–∞ —Å–∫–æ–ª—å–∫–æ –∫–∞–∂–¥–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ —ç—Ç–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É —É–º–µ–Ω—å—à–∞–ª–æ Gini impurity? –°—É–º–º–∏—Ä—É–µ–º –ø–æ –≤—Å–µ–º –¥–µ—Ä–µ–≤—å—è–º –∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º.

–ü—Ä–∏–∑–Ω–∞–∫–∏ —Å –±–æ–ª—å—à–∏–º –≤–ª–∏—è–Ω–∏–µ–º –Ω–∞ Gini –ø–æ–ª—É—á–∞—é—Ç –≤—ã—Å–æ–∫—É—é –≤–∞–∂–Ω–æ—Å—Ç—å.

> [!NOTE]
> Feature Importance –≤ Random Forest –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ Gini impurity, –ø–æ—ç—Ç–æ–º—É –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤—ã—Å–æ–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (–º–Ω–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π). –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –±–æ–ª–µ–µ –æ–±—ä–µ–∫—Ç–∏–≤–Ω—É—é –º–µ—Ä—É, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Permutation Feature Importance.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°–Ω–∏–∂–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –æ–¥–∏–Ω–æ—á–Ω—ã–º–∏ –¥–µ—Ä–µ–≤—å—è–º–∏
- –•–æ—Ä–æ—à–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –∏ —á–∏—Å–ª–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
- –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –£—Å—Ç–æ–π—á–∏–≤ –∫ –≤—ã–±—Ä–æ—Å–∞–º –∏ —à—É–º—É
- –ú–æ–∂–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ú–µ–Ω–µ–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º, —á–µ–º –æ–¥–∏–Ω–æ—á–Ω–æ–µ –¥–µ—Ä–µ–≤–æ
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º –Ω–∞ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö
- –ù–∞ –≤—ã—Å–æ–∫–æ—Ä–∞–∑–º–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç —É—Å—Ç—É–ø–∏—Ç—å –¥—Ä—É–≥–∏–º –º–µ—Ç–æ–¥–∞–º

> [!WARNING]
> Random Forest –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å—Å—è, –µ—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –æ—á–µ–Ω—å –º–Ω–æ–≥–æ —à—É–º–∞ –∏ –º–∞–ª–æ —Å–∏–≥–Ω–∞–ª–∞. –ù–∞ —Ç–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å min_samples_split, min_samples_leaf –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç—å max_features.

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Random Forest

- ‚úÖ –•–æ—Ä–æ—à–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç—å/–ø—Ä–æ—Å—Ç–æ—Ç–∞
- ‚úÖ –ù—É–∂–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ï—Å—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
- ‚úÖ –ù—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å Feature Importance
- ‚úÖ –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ç–æ–Ω–∫–∏–π –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚ùå –û—á–µ–Ω—å –±–æ–ª—å—à–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã (–º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ)
- ‚ùå –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (–ª—É—á—à–µ Gradient Boosting)

---

## –ß–∞—Å—Ç—å 2: AdaBoost (–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ë—É—Å—Ç–∏–Ω–≥)

### –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ

–ï—Å–ª–∏ Random Forest ‚Äî —ç—Ç–æ "—Å–ø—Ä–∞—à–∏–≤–∞–µ–º 100 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —ç–∫—Å–ø–µ—Ä—Ç–æ–≤", —Ç–æ AdaBoost ‚Äî —ç—Ç–æ "—É—á–∏–º—Å—è –Ω–∞ –æ—à–∏–±–∫–∞—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —ç–∫—Å–ø–µ—Ä—Ç–æ–≤".

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —à–∫–æ–ª—É, –≥–¥–µ –¥–µ—Ç–∏ —É—á–∞—Ç —É–º–Ω–æ–∂–µ–Ω–∏–µ. –£—á–∏—Ç–µ–ª—å –¥–∞—ë—Ç –≤—Å–µ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ç–µ—Å—Ç. –î–µ—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–≤–µ—Ç–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Ö–æ—Ä–æ—à–æ. –ù–æ –¥–µ—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—à–∏–±–ª–∏—Å—å, –ø–æ–ª—É—á–∞—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ: —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä, –±–æ–ª—å—à–µ –ø—Ä–∞–∫—Ç–∏–∫–∏.

–ó–∞—Ç–µ–º –¥–∞—ë–º –Ω–æ–≤—ã–π —Ç–µ—Å—Ç. –£—á–∏—Ç–µ–ª—å –æ–ø—è—Ç—å —Å–º–æ—Ç—Ä–∏—Ç, –∫—Ç–æ –æ—à–∏–±—Å—è, –∏ —Å–Ω–æ–≤–∞ –¥–∞—ë—Ç –∏–º –±–æ–ª—å—à–µ –≤–Ω–∏–º–∞–Ω–∏—è.

AdaBoost —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ. –ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º:
1. –û–±—É—á–∞–µ—Ç —Å–ª–∞–±—É—é –º–æ–¥–µ–ª—å (–æ–±—ã—á–Ω–æ –¥–µ—Ä–µ–≤–æ –≥–ª—É–±–∏–Ω—ã 1, –Ω–∞–∑—ã–≤–∞–µ–º–æ–µ "–ø–µ–Ω—å")
2. –°–º–æ—Ç—Ä–∏—Ç, –Ω–∞ –∫–∞–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö –æ–Ω–∞ –æ—à–∏–±–∞–ª–∞—Å—å—Ü—ã
3. –ù–∞ —Å–ª–µ–¥—É—é—â—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é –¥–∞—ë—Ç –±–æ–ª—å—à–∏–π –≤–µ—Å —ç—Ç–∏–º –ø—Ä–∏–º–µ—Ä–∞–º
4. –û–±—É—á–∞–µ—Ç –Ω–æ–≤—É—é —Å–ª–∞–±—É—é –º–æ–¥–µ–ª—å –Ω–∞ –≤–∑–≤–µ—à–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç AdaBoost

–ê–ª–≥–æ—Ä–∏—Ç–º –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π: –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –æ—à–∏–±–∫–∞–º.

**–®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**

–î–∞—ë–º –∫–∞–∂–¥–æ–º—É –ø—Ä–∏–º–µ—Ä—É –Ω–∞—á–∞–ª—å–Ω—ã–π –≤–µ—Å $\omega_i = \frac{1}{n}$ (–≤—Å–µ –ø—Ä–∏–º–µ—Ä—ã –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤–∞–∂–Ω—ã).

**–®–∞–≥ 2: –î–ª—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ $t = 1, 2, \ldots, T$:**

–û–±—É—á–∞–µ–º —Å–ª–∞–±—É—é –º–æ–¥–µ–ª—å $h_t(x)$ –Ω–∞ –≤–∑–≤–µ—à–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Å –≤–µ—Å–∞–º–∏ $\omega_i$).

–í—ã—á–∏—Å–ª—è–µ–º –≤–∑–≤–µ—à–µ–Ω–Ω—É—é –æ—à–∏–±–∫—É:

$\epsilon_t = \sum_{i: h_t(x_i) \neq y_i} \omega_i$

–í—ã—á–∏—Å–ª—è–µ–º "—Å–∏–ª—É" –º–æ–¥–µ–ª–∏ (confidence):

$\alpha_t = \frac{1}{2} \ln\left(\frac{1 - \epsilon_t}{\epsilon_t}\right)$

–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:
- –ï—Å–ª–∏ –º–æ–¥–µ–ª—å —É–≥–∞–¥–∞–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ ($\epsilon_t$ –º–∞–ª–æ), —Ç–æ $\alpha_t$ –±–æ–ª—å—à–æ–π (–º–æ–¥–µ–ª—å –≤–∞–∂–Ω–∞)
- –ï—Å–ª–∏ –º–æ–¥–µ–ª—å —É–≥–∞–¥–∞–ª–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ ($\epsilon_t$ –±–ª–∏–∑–∫–æ –∫ 1), —Ç–æ $\alpha_t$ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π (–∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ)

–û–±–Ω–æ–≤–ª—è–µ–º –≤–µ—Å–∞ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏:

$\omega_i^{(t+1)} = \omega_i^{(t)} \cdot e^{-y_i \alpha_t h_t(x_i)}$

–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:
- –ï—Å–ª–∏ –º–æ–¥–µ–ª—å $h_t$ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∞ –ø—Ä–∏–º–µ—Ä $i$, —Ç–æ $-y_i h_t(x_i) = 1$, –≤–µ—Å —Ä–∞—Å—Ç—ë—Ç
- –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Ç–æ $-y_i h_t(x_i) = -1$, –≤–µ—Å —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è

–ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –≤–µ—Å–∞: $\omega_i^{(t+1)} = \frac{\omega_i^{(t+1)}}{\sum_j \omega_j^{(t+1)}}$

**–®–∞–≥ 3: –§–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ**

–ö–æ–º–±–∏–Ω–∏—Ä—É–µ–º –≤—Å–µ –º–æ–¥–µ–ª–∏ –≤–∑–≤–µ—à–µ–Ω–Ω—ã–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –≥–æ–ª–æ—Å–æ–≤:

$F(x) = \text{sign}\left(\sum_{t=1}^T \alpha_t h_t(x)\right)$

### –ò–Ω—Ç—É–∏—Ü–∏—è AdaBoost

–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è: "focus on hard examples".

–ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –º–æ–¥–µ–ª–∏ –æ—à–∏–±–æ—á–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∏. –≠—Ç–æ –∫–∞–∫ –µ—Å–ª–∏ –±—ã –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏: "–û–∫–µ–π, —ç—Ç–æ—Ç –Ω–æ–≤—ã–π —É—á–∏—Ç–µ–ª—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–∞–º—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö".

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ AdaBoost

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ß–∞—Å—Ç–æ –¥–∞—ë—Ç —Ö–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–æ–¥—Å—Ç—Ä–æ–π–∫–æ–π
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±—É—é —Å–ª–∞–±—É—é –º–æ–¥–µ–ª—å (–Ω–µ —Ç–æ–ª—å–∫–æ –¥–µ—Ä–µ–≤—å—è)
- –ò–º–µ–µ—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏ (–º–æ–∂–µ—Ç –¥–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –æ—à–∏–±–∫–∞ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è)
- –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä—ã–π

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º (–æ–Ω–∏ –ø–æ–ª—É—á–∞—Ç –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–π –≤–µ—Å)
- –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å—Å—è –µ—Å–ª–∏ –¥–∞—Ç—å –µ–º—É –º–Ω–æ–≥–æ –∏—Ç–µ—Ä–∞—Ü–∏–π
- –ù–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è (–º–æ–¥–µ–ª–∏ –æ–±—É—á–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
- –¢—Ä–µ–±—É–µ—Ç –≤—ã–±–æ—Ä–∞ –±–∞–∑–æ–≤–æ–π —Å–ª–∞–±–æ–π –º–æ–¥–µ–ª–∏

> [!IMPORTANT]
> AdaBoost –±—ã–ª–∞ –æ–¥–Ω–∞ –∏–∑ –ø–µ—Ä–≤—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –∞–Ω—Å–∞–º–±–ª–µ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ (–∫–æ–Ω–µ—Ü 1990-—Ö). –•–æ—Ç—è —Å–µ–π—á–∞—Å —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Gradient Boosting, AdaBoost –≤—Å—ë –µ—â—ë –≤–∞–∂–Ω–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –æ—Å–Ω–æ–≤ –±—É—Å—Ç–∏–Ω–≥–∞.

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AdaBoost

- ‚úÖ –ù—É–∂–µ–Ω –±—ã—Å—Ç—Ä—ã–π –∏ –ø—Ä–æ—Å—Ç–æ–π –∞–Ω—Å–∞–º–±–ª—å
- ‚úÖ –î–∞–Ω–Ω—ã–µ —á–∏—Å—Ç—ã–µ (–±–µ–∑ –±–æ–ª—å—à–æ–≥–æ —à—É–º–∞ –∏ –≤—ã–±—Ä–æ—Å–æ–≤)
- ‚úÖ –ù—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å
- ‚ùå –î–∞–Ω–Ω—ã–µ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏ (AdaBoost –¥–∞—Å—Ç –∏–º –±–æ–ª—å—à–æ–π –≤–µ—Å)
- ‚ùå –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (–ª—É—á—à–µ Gradient Boosting)

---

## –ß–∞—Å—Ç—å 3: –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –ë—É—Å—Ç–∏–Ω–≥ (Gradient Boosting)

### –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ

–ï—Å–ª–∏ AdaBoost ‚Äî —ç—Ç–æ "–¥–∞–≤–∞–π—Ç–µ –¥–∞—ë–º –±–æ–ª—å—à–∏–π –≤–µ—Å –æ—à–∏–±–æ—á–Ω—ã–º –ø—Ä–∏–º–µ—Ä–∞–º", —Ç–æ Gradient Boosting ‚Äî —ç—Ç–æ "–¥–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –º–æ–¥–µ–ª–∏".

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç–µ —Ü–µ–Ω—É –∫–≤–∞—Ä—Ç–∏—Ä—ã. –ü–µ—Ä–≤–∞—è –º–æ–¥–µ–ª—å —É–≥–∞–¥–∞–ª–∞ —Ü–µ–Ω—É: 500,000. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ 520,000. –û—à–∏–±–∫–∞: 20,000.

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –º–µ–Ω—è—Ç—å –≤–µ—Å–∞, –º—ã –æ–±—É—á–∞–µ–º –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–æ–≤–Ω–æ —ç—Ç—É –æ—à–∏–±–∫—É: 20,000. –ï—Å–ª–∏ –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å —É–≥–∞–¥–∞–µ—Ç –æ—à–∏–±–∫—É, —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç 500,000 + 20,000 = 520,000.

–≠—Ç–æ —Å—Ç–µ—Ä–∂–µ–Ω—å Gradient Boosting: –∫–∞–∂–¥–∞—è –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –Ω–∞ –æ—Å—Ç–∞—Ç–∫–∞—Ö (residuals) –ø—Ä–µ–¥—ã–¥—É—â–µ–π.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Gradient Boosting

**–®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**

–ù–∞—á–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å: –æ–±—ã—á–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏).

$F_0(x) = \bar{y}$

**–®–∞–≥ 2: –î–ª—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ $m = 1, 2, \ldots, M$:**

–í—ã—á–∏—Å–ª—è–µ–º –æ—Å—Ç–∞—Ç–∫–∏ (residuals) —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏:

$r_i = y_i - F_{m-1}(x_i)$

–û–±—É—á–∞–µ–º –Ω–æ–≤–æ–µ –¥–µ—Ä–µ–≤–æ $f_m(x)$ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –æ—Å—Ç–∞—Ç–∫–∏:

$f_m(x) = \arg\min_f \sum_{i=1}^n L(r_i, f(x_i))$

–≥–¥–µ $L$ ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (–æ–±—ã—á–Ω–æ Mean Squared Error).

–î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –¥–µ—Ä–µ–≤–æ –≤ –∞–Ω—Å–∞–º–±–ª—å —Å learning rate $\nu$ (–æ–±—ã—á–Ω–æ 0.01-0.1):

$F_m(x) = F_{m-1}(x) + \nu \cdot f_m(x)$

Learning rate –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç, –Ω–∞ —Å–∫–æ–ª—å–∫–æ –º—ã "–≤–µ—Ä–∏–º" –Ω–æ–≤–æ–º—É –¥–µ—Ä–µ–≤—É. –ú–∞–ª—ã–π learning rate (0.01) –¥–∞—ë—Ç –º–µ–¥–ª–µ–Ω–Ω–æ–µ, —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ. –ë–æ–ª—å—à–æ–π learning rate (0.1-1) ‚Äî –±—ã—Å—Ç—Ä–æ–µ, –Ω–æ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å—Å—è.

### –ü—Ä–∏–º–µ—Ä: –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ü–µ–Ω—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏

| Area | Price | $\hat{y}_0$ | $r_1$ | $f_1$ | $\hat{y}_1$ |
|------|-------|-----------|-------|-------|-----------|
| 200  | 500   | 550       | -50   | -45   | 505       |
| 190  | 450   | 550       | -100  | -95   | 455       |
| 230  | 650   | 550       | 100   | 105   | 655       |

–ü–µ—Ä–≤–∞—è –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞ –¥–ª—è –≤—Å–µ—Ö 550 (—Å—Ä–µ–¥–Ω–µ–µ). –û—Å—Ç–∞—Ç–∫–∏: -50, -100, 100.

–í—Ç–æ—Ä–∞—è –º–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —ç—Ç–∏ –æ—Å—Ç–∞—Ç–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Area).

–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: $\hat{y} = 550 + 0.5 \times f_1(x)$

### Gradient Boosting –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

–î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ.

$P(y=1|x) = \frac{1}{1 + e^{-F(x)}}$

$F(x) = \log\left(\frac{P}{1-P}\right)$

–û—Å—Ç–∞—Ç–∫–∏ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –≥—Ä–∞–¥–∏–µ–Ω—Ç log-loss:

$r_i = y_i - P(y_i = 1|x_i)$

–û—Å—Ç–∞–ª—å–Ω–æ–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏—é.

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã Gradient Boosting

**n_estimators (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π):**

–û–±—ã—á–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: 100-1000. –ë–æ–ª—å—à–µ = –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –ª—É—á—à–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∏ —Ä–∏—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è.

**learning_rate (—Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è):**

–î–∏–∞–ø–∞–∑–æ–Ω: 0.001-1. –û–±—ã—á–Ω–æ 0.01-0.1.

–ú–∞–ª—ã–π learning_rate: –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π, –Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π.
–ë–æ–ª—å—à–æ–π learning_rate: –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ–ø—Ç–∏–º—É–º.

–°–æ–≤–µ—Ç: —É–º–µ–Ω—å—à–∏—Ç–µ learning_rate –∏ —É–≤–µ–ª–∏—á—å—Ç–µ n_estimators. –û–±—ã—á–Ω–æ –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —á–µ–º –±–æ–ª—å—à–æ–π learning_rate –∏ –º–∞–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π.

**max_depth (–≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤—å–µ–≤):**

–û–±—ã—á–Ω–æ 3-8 (–Ω–∞–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ, —á–µ–º –≤ Random Forest).

–î–µ—Ä–µ–≤—å—è –≤ Gradient Boosting –Ω–∞–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ, —á–µ–º –≤ Random Forest. –≠—Ç–æ —Å–ª–µ–¥—É–µ—Ç –∏–∑ —Ç–µ–æ—Ä–∏–∏: –º–Ω–æ–≥–æ —Å–ª–∞–±—ã—Ö –º–æ–¥–µ–ª–µ–π –ª—É—á—à–µ, —á–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω—ã—Ö.

**subsample (–¥–æ–ª—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è):**

–û–±—ã—á–Ω–æ 0.5-1. –ú–µ–Ω—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ = –∫–∞–∂–¥–æ–µ –¥–µ—Ä–µ–≤–æ –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –ø–æ–¥–≤—ã–±–æ—Ä–∫–µ, –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ.

> [!TIP]
> –¢–∏–ø–∏—á–Ω—ã–π Setup –¥–ª—è Gradient Boosting: n_estimators=500, learning_rate=0.1, max_depth=3, subsample=0.8. –ó–∞—Ç–µ–º –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ —á–µ—Ä–µ–∑ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é.

### Early stopping (—Ä–∞–Ω–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞)

–û–¥–Ω–∞ –∏–∑ –º–æ—â–Ω–µ–π—à–∏—Ö —Ç–µ—Ö–Ω–∏–∫ –≤ Gradient Boosting: —Å–º–æ—Ç—Ä–∏–º –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ, –∏ –µ—Å–ª–∏ –æ–Ω–æ –Ω–µ —É–ª—É—á—à–∞–µ—Ç—Å—è $N$ –∏—Ç–µ—Ä–∞—Ü–∏–π –ø–æ–¥—Ä—è–¥, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è.

–≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–≥–∞–¥—ã–≤–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ n_estimators.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ Gradient Boosting

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –û–±—ã—á–Ω–æ –¥–∞—ë—Ç –Ω–∞–∏–≤—ã—Å—à—É—é —Ç–æ—á–Ω–æ—Å—Ç—å —Å—Ä–µ–¥–∏ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±—É—é –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å
- Early stopping –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
- –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ú–µ–¥–ª–µ–Ω–Ω–µ–µ –æ–±—É—á–∞–µ—Ç—Å—è, —á–µ–º Random Forest (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
- –¢—Ä–µ–±—É–µ—Ç –ø–æ–¥–±–æ—Ä–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (learning_rate, max_depth)
- –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å—Å—è –Ω–∞ –º–∞–ª—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ú–µ–Ω–µ–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º

> [!NOTE]
> –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ ‚Äî –æ—Å–Ω–æ–≤–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ Machine Learning. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–∞—á–Ω–∏—Ç–µ –∏–º–µ–Ω–Ω–æ —Å –Ω–µ—ë.

### –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**Scikit-Learn GradientBoostingClassifier/GradientBoostingRegressor:**

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, –º–µ–¥–ª–µ–Ω–Ω–∞—è, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è.

**XGBoost (Extreme Gradient Boosting):**

–ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏. –ß–∞—Å—Ç–æ –ª—É—á—à–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π Kaggle.

**CatBoost (–æ—Ç –Ø–Ω–¥–µ–∫—Å–∞):**

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –ù–µ –Ω—É–∂–Ω–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞.

**LightGBM (–æ—Ç Microsoft):**

–û—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPU. –•–æ—Ä–æ—à–∞ –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

–í—Å–µ —ç—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ—Ç –∂–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏–Ω—Ü–∏–ø, –ø—Ä–æ—Å—Ç–æ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏.

> [!WARNING]
> XGBoost, CatBoost –∏ LightGBM –∏–º–µ—é—Ç —Å–≤–æ–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–º–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç scikit-learn. –ß–∏—Ç–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ!

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Gradient Boosting

- ‚úÖ –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
- ‚úÖ –ï—Å—Ç—å –≤—Ä–µ–º—è –Ω–∞ –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ï—Å—Ç—å —Ç–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- ‚úÖ –ù—É–∂–Ω–∞ –±—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ XGBoost/LightGBM)
- ‚ùå –°–æ–≤—Å–µ–º –º–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–µ–æ–±—É—á–∏—Ç—Å—è)
- ‚ùå –û—á–µ–Ω—å –≤—ã—Å–æ–∫–æ—Ä–∞–∑–º–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ)

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª–µ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤

| –ú–µ—Ç–æ–¥ | –û–±—É—á–µ–Ω–∏–µ | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ | –¢–æ—á–Ω–æ—Å—Ç—å | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è | –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º |
|---|---|---|---|---|---|
| Random Forest | ‚ö°‚ö° | ‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê | ‚úÖ –ü–æ–ª–Ω—ã–π |
| AdaBoost | ‚ö°‚ö° | ‚ö° | ‚≠ê‚≠ê | ‚≠ê‚≠ê | ‚ùå –ù–µ—Ç |
| Gradient Boosting | üêå | ‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê | ‚ùå –ù–µ—Ç |
| XGBoost | ‚ö° | ‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê | ‚úÖ –ß–∞—Å—Ç–∏—á–Ω—ã–π |
| LightGBM | ‚ö°‚ö°‚ö° | ‚ö°‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê | ‚úÖ GPU |

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –∞–Ω—Å–∞–º–±–ª–µ–≤—ã–π –º–µ—Ç–æ–¥

1. **–ù–∞—á–Ω–∏—Ç–µ —Å Random Forest:**
   - –ë—ã—Å—Ç—Ä–æ –æ–±—É—á–∞–µ—Ç—Å—è
   - –•–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–µ–∑ –ø–æ–¥–±–æ—Ä–∞
   - –õ–µ–≥–∫–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å

2. **–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ª—É—á—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å ‚Üí Gradient Boosting:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ scikit-learn –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
   - –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ XGBoost –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
   - –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ learning_rate –∏ max_depth

3. **–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ ‚Üí LightGBM:**
   - –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è
   - –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU
   - –•–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –º–∏–ª–ª–∏–æ–Ω–∞—Ö —Å—Ç—Ä–æ–∫

4. **–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Feature Importance –∏–∑ Random Forest
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ SHAP values –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è
   - –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Gradient Boosting —Å –º–∞–ª—ã–º n_estimators

### –û–±—â–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∞–Ω—Å–∞–º–±–ª–µ–π

‚ùå **–û—à–∏–±–∫–∞ 1:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–Ω–æ–≥–æ —Å–ª–∞–±—ã—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –≤–º–µ—Å—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –±—É—Å—Ç–∏–Ω–≥–∞. Random Forest –∏ Boosting —Ä–µ—à–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã.

‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ª—É—á—à–∏–π.

‚ùå **–û—à–∏–±–∫–∞ 2:** –ó–∞–±—ã—Ç—å –ø—Ä–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –î–µ—Ä–µ–≤—å—è –≤ –∞–Ω—Å–∞–º–±–ª—è—Ö –Ω–µ —Ç—Ä–µ–±—É—é—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ.

‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –•–æ—Ç—è –¥–µ—Ä–µ–≤—å—è –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é, —Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å –æ—á–∏—â–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

‚ùå **–û—à–∏–±–∫–∞ 3:** –ü–æ–¥–æ–±—Ä–∞—Ç—å –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ. –£ –∞–Ω—Å–∞–º–±–ª–µ–π –ª–µ–≥–∫–æ –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å—Å—è.

‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é –≤—ã–±–æ—Ä–∫—É.

‚ùå **–û—à–∏–±–∫–∞ 4:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å n_estimators=10000. –ù–∞ –∫–∞–∫–æ–º-—Ç–æ –º–æ–º–µ–Ω—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ä–µ–≤—å–µ–≤ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç.

‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ early stopping –∏–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

---

## –ò—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã

–ê–Ω—Å–∞–º–±–ª–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã ‚Äî –æ–¥–Ω–∏ –∏–∑ —Å–∞–º—ã—Ö –º–æ—â–Ω—ã—Ö –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏:

- **Random Forest:** –•–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏
- **AdaBoost:** –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –≤–∞–∂–Ω–æ—Å—Ç—å, –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–∞ –Ω–∞ —á–∏—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **Gradient Boosting:** –û–±—ã—á–Ω–æ –ª—É—á—à–∏–π –≤—ã–±–æ—Ä –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ù–∞—É—á–∏—Ç–µ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –º–µ—Ç–æ–¥—ã, –∏ –≤—ã –±—É–¥–µ—Ç–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã –Ω–∞ –ª—é–±–æ–º —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–∏ –ø–æ –º–∞—à–∏–Ω–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é.

–ü–æ–º–Ω–∏—Ç–µ: –Ω–µ—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ –ª—É—á—à–µ–≥–æ –º–µ—Ç–æ–¥–∞. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–±—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤ –∏ –≤—ã–±–∏—Ä–∞–π—Ç–µ –ª—É—á—à–∏–π –¥–ª—è –≤–∞—à–µ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏.